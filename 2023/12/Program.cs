using System.Diagnostics;
using common;


namespace _12
{

    internal class Program
    {

        const StringSplitOptions Tidy = StringSplitOptions.TrimEntries | StringSplitOptions.RemoveEmptyEntries;

        static readonly string xinput = @"
???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1
";


        static async Task Main(string[] args)
        {
            var strings = input.Split("\r\n", Tidy);
            var all = strings
                .Select(s => Wells.Parse(s, 5))
                .ToList();
            var results1 = Results(all);
            ulong sum = 0;
            for (int i = 0; i < results1.Length; i++)
            {
                sum += (ulong)results1[i];
            }

            Debug.WriteLine("all :" + sum);
        }

        private static long[] Results(List<Wells> all)
        {
            var sum = 0L;
            var x = new Stack<Wells>();
            all.Reverse();
            foreach (var s in all)
            {
                x.Push(s);
            }

            long[] results = new long[all.Count];
            Task[] tasks = new Task[all.Count];

            void Start(Wells result, int index)
            {
                results[index] = -1;
                tasks[index] = Task.Run(() =>
                {
                    try
                    {
                        results[index] = Permutate(index, result);
                    }
                    catch (Exception e)
                    {
                        Debug.WriteLine("Error " + e.Message);
                        throw;
                    }
                });
            }

            var i = 0;
            while (x.Count > 0)
            {
                var waitFor = tasks.Where(t => t != null && t.Status != TaskStatus.RanToCompletion).ToArray();
                var taskCnt = waitFor.Length;
                Task.WaitAny(waitFor);


                while (taskCnt < 40)
                {
                    var found = x.TryPop(out Wells? line);
                    if (found)
                    {
                        results[i] = -1;
                        Start(line!, i);
                        taskCnt++;
                        i++;
                    }
                    else
                    {
                        break;
                    }
                }

                Thread.Sleep(50);
                waitFor = tasks.Where(t => t != null && t.Status != TaskStatus.RanToCompletion).ToArray();
                taskCnt = waitFor.Length;

                if (x.Count == 0)
                {
                    Task.WaitAll(waitFor);
                }

                if (taskCnt > 19)
                {
                    Thread.Sleep(500);
                }
            }

            Thread.Sleep(500);
            return results;
        }

        private static long Permutate(int line, Wells wells)
        {
            return wells.Solve(line);
        }

        public class Wells
        {
            public Wells(char[] chars, IEnumerable<int> figures)
            {
                Springs = chars;
                BrokenGroups = figures!.ToArray();
                CountOfBroken = BrokenGroups.Sum((x => x));
                CountOfSprings = Springs.Length;

                After = new();
                for (int i = 0; i < CountOfSprings; i++)
                {
                    var rest = Springs.Skip(i);
                    var broken = rest.Count(x => x == '#');
                    var splits = rest.Count(x => x == '.');
                    var wc = rest.Count(x => x == '?');
                    After.Add((broken, splits, wc));
                }

                MinimumBroken = After[0].broken;
            }

            public int MinimumBroken { get; set; }

            public int CountOfSprings { get; set; }

            public int CountOfBroken { get; set; }

            public char[] Springs { get; private set; }
            public int[] BrokenGroups { get; private set; }
            public List<(int broken, int splits, int wc)> After { get; private set; }

            public static Wells Parse(string s, int i)
            {
                var parts = s.Split(" ", Tidy).ToArray();
                var figures = parts[1].Split(",").ToArray();
                var wells = new Wells(parts[0].ToCharArray(), figures.Select(x => x.ToInt() ?? 0));
                if (i > 1)
                {
                    var w = Enumerable.Repeat(("?" + wells.Springs.StringJoin("")).ToCharArray(), i).SelectMany(x => x)
                        .Skip(1).ToArray();
                    var f = Enumerable.Repeat(wells.BrokenGroups, i).SelectMany(x => x).ToArray();
                    wells = new Wells(w, f);
                }

                return wells;
            }

            public long Solve(int line)
            {
                try
                {
                    var solutions = CountArrangements();
                    Debug.Write(line + "> " + Springs.StringJoin("") + " " +
                                BrokenGroups.Select(x => "" + x).StringJoin(","));
                    Debug.WriteLine("   sol:" + solutions);
                    return solutions;
                }
                catch (Exception e)
                {
                    Debug.WriteLine(e);
                    throw;
                }
            }

            long CountArrangements()
            {
                var countArrangements = 0L;

                var possibleOffsets = Springs
                    .Select((c, i) => (c, i))
                    .Where(x => x.c != '.')
                    .Select(x => x.i)
                    .ToList();

                var work = new List<(int brokenIndex, int offset, long count)>();

                // enqueue all possible offsets for first broken
                EnqueueWork(0, 0, 0, 1);

                while (work.Count > 0)
                {
                    var (brokenIndex, offset, count) = work[0];
                    work.RemoveAt(0);

                    var brokenGroupLength = BrokenGroups[brokenIndex];
                    var offsetEnd = offset + brokenGroupLength;

                    // check if we can place the broken here
                    if ((offset == 0 || Springs[offset - 1] != '#')
                        && (offsetEnd == Springs.Length || offsetEnd < Springs.Length && Springs[offsetEnd] != '#')
                        && !Springs.AsSpan(offset, brokenGroupLength).Contains('.'))
                    {
                        // did we reach the end?
                        if (brokenIndex == BrokenGroups.Length - 1)
                        {
                            // if there are # left, we did not find a solution
                            if (Springs.AsSpan(offsetEnd).Contains('#')) continue;

                            countArrangements += count;
                        }
                        else
                        {
                            // find next possible that should fit
                            var nextPossibleIndex = possibleOffsets.BinarySearch(offsetEnd + 1);
                            if (nextPossibleIndex < 0) nextPossibleIndex = ~nextPossibleIndex;

                            // enqueue next possible offset for next brokens
                            EnqueueWork(brokenIndex + 1, offsetEnd, nextPossibleIndex, count);
                        }
                    }

                }

                return countArrangements;

                void EnqueueWork(int brokenGroupIx, int offsetEnd, int nextPossibleIndex, long count)
                {
                    for (var i = nextPossibleIndex; i < possibleOffsets.Count; i++)
                    {
                        var nextOffset = possibleOffsets[i];

                        // if we find # in between, we must stop
                        if (Springs.AsSpan(offsetEnd, nextOffset - offsetEnd).Contains('#'))
                        {
                            break;
                        }

                        // find duplicates
                        var wi = work.FindIndex(w => w.brokenIndex == brokenGroupIx && w.offset == nextOffset);
                        if (wi >= 0)
                        {
                            work[wi] = work[wi] with { count = work[wi].count + count };
                        }
                        else
                        {
                            work.Add((brokenGroupIx, nextOffset, count));
                        }
                    }
                }

            }
        }


        private static readonly string input =
            @"
?.???#????? 1,3,1
..???#??????#?????? 3,6
???#??.????. 4,1,1,2
??#?????????#?##?? 4,4,2,4
??..???.????#??? 2,1,6
?#???#.????.??. 2,1,1,2,2
#??.???### 1,1,5
?????#?###?#???.???# 3,9,1,1,1
###????.??#####.??? 6,5
.?##???.#? 3,2
?.?#??#??..# 3,1,1
?.?????.?????? 1,3,1,3
.#.?#?.???. 1,3,2
??#?#????#..???????? 5,1,4,2
??.?#??##?? 1,1,2
?????.????##?#? 1,1,7
?#?#??..#?. 5,2
???.#???.????#???? 1,1,1,1,6,1
?.??##?#????? 6,3
??..??#?#????????.# 1,1,1,1,4,1
??????##???????? 2,4,6
?##..?##?##??.?#.? 2,8,1,1
???#??.?###.?????. 3,3,2
..#?...?#?? 2,4
#?.?#.?.???#?#? 2,1,1,1,4
???##?.??#?.?? 6,1,2,1
.#????.??? 1,2
?.?..##??#?#?#??.. 1,1,2,4,1,1
?#??#?#??#?#?.??#?? 11,4
??#?##??##???? 1,8
???#??.#?? 2,1,2
??#???#??.#.?#??#??? 3,2,1,8
????#???.???# 1,1,2,2
??#?.????? 4,2
???????..?##???.? 4,6
???.??????.??? 1,1,6,2
???.#???????.#??? 1,1,2,1,3
?.#????????? 1,1,1,1
?#???????????.??#.?. 5,1,1,1,1,1
????##?##?#???#?#??. 1,10,2,1,1
???#?.?.?? 5,1,1
.????#??#.#??# 1,4,4
?????..??##.?..?? 1,4
#?#???#?##??.??????? 1,10,1,1
??.????#????#????? 1,1,12
#?.#.???###???#??? 1,1,1,6,1,2
?.???.?????????#.?? 1,4
?##?###?????##.#??#? 7,3,1,2
???#?????? 3,1
.?#????#?#?.#???#?? 7,1,2,2
.?#??.??.####.#? 1,2,4,1
?.?.?????##.?.?.#.? 1,1,4,1,1,1
.????.??#??????## 1,3,5
?.###???????? 1,3,2
????????????. 7,2
???.?###.##???#?.?? 3,4,6,2
??#?#?###??????.?? 7,3
#.??#????? 1,1,3
.??#?#?.??.?#? 3,2,1,3
?.?#????.?. 2,1
???.?#??#????? 2,6,1
#??????##????? 1,1,8
???.##..??#?#?#.??? 1,2,1,1,3,1
???.?????#??????? 2,6,2,3
????#???#??#??.??#?? 2,9,3
??????????.?#? 3,1,3,3
??#?#????#? 1,1,4
#??##???#???? 10,1
#?.??????#???.# 2,7,1,1
??#?.???#??????. 1,8
.?##?????#?? 3,3
?....??????.#.?. 1,5,1,1
.???#.????? 2,1,2
??#??????#?#????##? 1,16
##?.#?????#???.#??? 3,2,3,2,2,1
???##???##????.???? 10,3
??.???.???#?.?? 2,2,3
.??#????..???# 5,1,4
?#?.?#?#??#?#???? 1,12
.?#??.??#?? 2,3
?#?#???#????? 4,4,2
.???#..????#? 1,5
?##?#??????..???? 8,1,1
#?##??.?#.#???##???? 6,1,1,6
#??.????#?? 1,1,6
#???#????.??????#??? 1,3,1,1,7,1
?.?#?#?.?#????. 4,1,2
##??.#?????.# 2,1,2,1
?.????????##??# 6,4,1
?..#....?# 1,1,1
?##??.??#??#? 4,2,3
??#??????????? 3,4,3
.#???.???????? 3,5,1
???.?.????????.? 1,5
????##????? 3,2,2
???##?##???#??????# 10,2,1,2
?#?.???????#? 3,1,1,1
???#????#??# 1,2,4
?.??#..??? 1,3,2
?.??#???.??? 3,1
??????#??## 1,6
.?#?.#???? 2,1,1
?????????##.? 1,7
?..?.?.?#??? 1,4
.?#??#????????#.#? 3,1,2,1,1,1
?.???.?#??.. 1,2
?#?#????.##?##???# 4,2,5,1,1
?#.#??#?#?#?? 1,8
##?.????##? 3,6
?????????? 1,2,1
??.#??.#??. 1,1,1
?#??#.??#???.?#. 5,3,1,1
??##?#?????. 5,2
?.??#?????? 3,2
#????????? 1,7
??.#?..???#? 1,5
##???##?#?? 2,4,2
?#?.??#??.?.? 2,3,1
???##???.??# 1,5,1,1
?#??.?.?#.????# 1,1,1,3,1
?.?.#.?????????#.# 1,1,1,6,1,1
??#?????#???##??#?## 5,12
?#???#?????. 7,2
???.?#???? 1,2
???.??????.?#??#?? 2,1,1,2,1,1
???#?.#?##? 2,1,5
?#??.??.?? 3,2,1
??#.???#.???. 1,2,1,2
??.??????????##..??? 4,7,2
???#??.##?????.. 1,1,7
???#????#..#?.??? 6,1,2,1
????????#? 1,4,1
###?????.####.?? 5,4
?#?##??#.??. 7,1
?#????????????#?? 2,6,1,1,1
.?#?????#??? 2,5
??#????#####?#.# 4,6,1,1
?????#???#??? 2,6,1
.?..????.#?? 1,1,1,3
..?????#?#?###?. 1,10
?.##??#??.??.???#? 2,2,1,4
???????.#????#?#?.# 1,1,1,8,1
???#?.??.??? 5,1,1,1
??.?#???#?????.? 1,2,5,1,1
.??.???#?##? 1,1,1,2
.?#.?#?????# 1,1,3,1
#?##?????###???????. 1,2,1,7,1,1
.##???#.??#??.? 3,2,1,3,1
??###.??.?????? 5,1,1,2,1
?.??####??????.#???? 7,2,5
?????#?.?? 3,2,1
???????.??#?? 1,2
.?.???#?#??.? 1,1,5,1
????.??.##???. 2,2
??.#????##???? 1,1,1,6
?.???##????.??. 1,1,5,2
????.??????##?#??? 2,11
??????#?####???# 12,1
?#???.???# 3,1,3
?????????#?#? 1,2,6
???.??#.?. 2,3
..#..?#?.??.# 1,3,1,1
?#?#???#.#?#.?? 3,3,1,1,1
?#?##?????? 6,3
.?#???#.?.?##?#????? 2,1,1,9
??.??#???## 1,3,4
.#?.?????..?#??? 2,4,5
?#????#.??? 3,1,1
??.#???#?###????## 1,1,13
???.###???#???.#. 2,7,1,1
.????.?.?????? 3,1,3
#???????????..#.. 4,1,1,1,1
?.?.##??.??.????. 1,1,3,2,4
???????.????? 4,1,1,1
??#??#.????.?? 6,3,1
???#?????##????##?? 1,3,1,10
?#???#????.?##?. 1,1,2,2
??????#?.???#.? 1,3,1,2
##???????? 5,3
?#?###?.?.???????# 6,1,1,1,1
???????.#?? 1,1,2
.????.??#?.?#.??.. 2,2,1
??????..?.?.??.. 4,1,1
#???#??#??????##? 2,1,10
??????..#.???. 1,1,1,3
??????????#????# 6,3,1,1
??.?????.? 2,2,1
?.?????#???.??# 3,5,2
#?#.???#??..?#? 1,1,1,3,3
??.??..??#.???##???? 1,2,1,1,6,2
?.??##?##?.?.??#??? 8,4
#????##????????#?# 1,1,2,4,4
#?#.???#?.?????? 3,2,1,6
#??????????..#??? 2,5,3
????.??.??.#.#?#?? 3,1,2,1,1,3
???#?##??? 6,2
????????.#?? 1,1,1,2
##?.#????#?#?. 2,1,2,1
??#??????#??#?. 1,1,1,2,5
????..???? 1,1,3
.?..?#.?????.?? 1,1
.?##??.#..?????#? 2,1,6
??.?#..???? 1,1,2
#??#??#???????????? 4,1,2,2,2
..???.??????#?? 1,3,4
?.#??.??????#? 1,6
#??????#???##???? 1,2,4,4,1
??.??????? 1,1,3
.???#???##????#? 1,6,4
??#???.????#. 3,1,4
#?.??????? 1,1,1
??##???????????????# 1,4,1,1,6,1
#?????##????????? 1,1,5,2
##?????#?##?#?.? 2,10
##???#.?#.?##?. 3,1,1,3
??#?.????? 3,1
.?#.???.?#?#???#??? 2,1,1,6,4
#???#?#??????. 1,3,1,2
.??????.?.??. 1,3,1,1
.??##????.? 5,1
..??.???##??????..? 1,5,1
.#..???????? 1,3,1
??.???.???###.??.? 2,6
?##????#?#..?#? 3,3,1,3
??#.??#.???#? 2,3,5
?#???#?????##????#.? 5,1,5,1
??.???###?????????? 8,3
?##?#?#?...#????#??? 7,1,5
???#???#??#.????? 1,6,2,4
?.?#???##.? 4,2
.?.????####. 1,5
?.#??.?#?. 3,1
..?#??.??.?#?#???? 3,6
?.??????#? 1,7
?.????.??.?####???? 1,2,1,1,6,1
?#..#????????? 1,1,3,1
?#????##.???#???? 3,3,4
.???.?#?..# 1,2,1
.##?#?###??.??? 9,3
#?.????#??###??##? 1,5,5,2
?????????#. 6,1
#?????.#?. 5,2
??????????? 2,3
.??#.???....#.? 3,1,1,1,1
??.??#??????.???? 1,4,1,3
.?#.#?#???##???#. 1,1,1,1,6
?#..?.?.??? 2,1
?????.?#?. 1,1,2
??#?#??????#???? 8,2
???..???##?????.? 2,6,1,1
?.????..??#?.? 1,3
???.??.?#?#.? 1,1,3,1
?#???###?##?? 1,7
??.####?????#.... 6,1
???#?.#?.?? 2,1,1
?.???#??#?#.????? 1,4,1,1,3
?.??.????????. 1,4,1
.?#????#???.? 4,2,1
#?#.??.?.?###?????.? 1,1,1,1,3,3
?#??.??##??#?##?#? 4,8,2
.?????.#?? 1,1
??..#?.??????#? 2,1,7
??##????##?.?? 1,9
?#????#?#?.?.?? 4,1,2,1,1
?#???#??.????#? 1,4,1,2
??.????#?. 2,2,2
??????#.???##??? 4,1,1,3,1
?##??##?.???.##?. 2,3,1,2
.????????#?. 5,1
.??.????????#? 1,2,5
??.??##?#?.????????? 1,1,2,1,8
#?###?????# 5,1,2
#?.???#..? 1,3
.??????.#?.#.? 4,1,1
?.??.???#??#? 2,1,2,1
????..???##?????? 1,5
??#??????.????#.. 7,5
?###???#?.?.???## 7,4
??.?.?????.?? 1,3
???#??????????? 1,1,2,1,1
.??#.????? 2,4
.???????.?#? 3,1,1
#.?.#??#???? 1,2,1,2
???#??##??????#??.?? 11,1,2,1
#???????.?#?..?#? 3,1,1,3,1
?#?#.?.????.??? 1,1,1,1,1
???.#????????? 1,9
???##??????.?#???# 9,1,1,1,1
?..?????????.?...? 1,2
????.#?#?#? 2,1,5
???#????.?#???.??? 1,2,1,3,1,2
???.##??????.?#? 1,5,1,1
..????????#? 3,3
?.?#??#.??????.#? 1,4,1,1,2
?.???.??.? 1,1,1
??????##?#?#?.????# 8,4,2,1
??#?#?????#. 7,2
.??#???.?.#??????##? 2,1,9
.?##??#????.? 2,5
.?.?##?.#.?.##.?#? 1,2,1,1,2,2
?????#???#?. 1,6
.#???????#????#?##?# 2,11,2,1
???#???????.#??.?? 1,5,2,2,1
????????.????##???#? 2,2,8
??????###?#?????#??# 8,1,6,1
???#?.??###.?? 1,1,4,1
??.???#???##??.#?#?# 1,10,1,1,1
??#?#?????#?????? 3,3,1,1,4
..?????#?.#. 3,1,1
??????????.??#????# 3,4,2,3
?..?#?.??.#???#?#?. 1,3,1,3,1,2
.???#???#?? 2,3
?.?#?..?#?? 1,1,2
???????#?? 1,1,3
???.??...? 3,1
??##.??.?????#.????? 2,6
??#???#?#???.? 1,8
?##??????? 6,2
????????????#?#?? 5,4,1
#.????#?.?. 1,1,2
???#??.?#. 1,3,2
#?.???#?????.# 1,1,7,1
?###..??.??? 4,1,2
#??????..#?? 3,1,1
???#???#?#?#???.?? 1,13
???????#??????## 5,1,6
.??.???.???###. 2,1,5
#.#???#??#?#?????# 1,1,8,1,2
?..????##?.#? 1,1,4,1
????###?????#??? 1,10,1
????##?????? 2,2,4
.?????????##?? 1,9
.?.?##.?#?#? 3,3
..??##?##?#?#??? 4,7
????##????#??????? 4,4
#??#??#??? 4,4
??.??????#??##?. 1,1,6
?.??#?????.#??#? 1,3,1,1,1
.??#????#????## 8,1,2
.?##..???..? 2,1
??.??????? 1,2,1
?.?#?????#?#?.#..?.? 1,11,1,1,1
??????.?.??? 4,2
..????????? 3,4
???#?#?#?.?#.?? 9,2,1
??##?##??#? 6,1
?.?.?#???#. 1,1,5
???#????#???##???.. 9,4
?##???#??? 3,1
.?#?.?.#??? 1,3
????????????#?. 6,1,2
.##?#??#?#?# 9,1
?#?#.?..?. 3,1
#????#.?.??? 2,1,2
??..#????..??##? 2,5,3
??##?#??.??#???##?.? 6,1,5
??????..?? 2,1
#??#?.????#?.#?.? 1,1,5,1,1
???##???.#?#?? 5,3
??#?#??.????? 4,1,1
.#??#?#??#.?.?##?? 6,1,1,4
.?..????.??#? 2,3
#???#??###.#? 5,3,1
?#?#??###?????#? 10,2
??.?#??#.?..????.??? 1,5,1
#??#.#??#?????.?#?? 2,1,4,3,2,1
???##??...????????#? 1,5,1,2,5
?#?????????????.???# 4,4,1,3
.#?????##?????# 8,1,3
.??##??????##?? 4,3,2
?????#.?#?.?????.# 1,1,1,2,2,1
???????.?#? 1,1,2
??#.???#????# 3,1,1,3
#?????#??? 1,3,3
??.??#?##.#??? 6,3
?????.?????. 1,2,2,1
?????.????#?????? 1,1,4,1
??##?????.?????##?? 1,5,1,2,5
.?????#?#?#.?.#.# 8,1,1,1,1
???#?#?????##???.?? 16,1
????.#????.????#?? 1,3
???#??.#??? 4,2
??.#.?#?#?????# 1,1,5,1,2
#?#???#.???????#???? 1,5,1,3,3
.?#????#???????? 1,1,1,1,4
???.???#??????## 1,1,9
#??.?##?.???#? 1,3,5
???.??.??..??? 3,1,1,2
#????.#.#? 3,1,1
?#?##?#??#?..?????## 9,2,1,2
????.#??#???.????? 1,1,2,4,1,2
#??..??.????? 3,1,1,1
#???#??#????? 3,1,6
??###??#??#?##???#. 3,2,8
??#???.?#????? 3,5
????##??.????#?#? 1,3,5,1
#?.?....?#. 2,1,1
?.##??##???#????#? 11,4
?#?..#?.???#?#?##. 3,1,7
?????.?.#.?.?. 5,1,1,1
??#???.#??? 4,2
?#..???#?#?##??#?. 1,10
#?..??????? 2,5
???##??????. 1,2,1,1
#??.???????????#??? 1,1,1,7,2,1
??.???##??#???? 1,1,3,3,1
?####?#?#?????.???? 12,1,1
???##?##?.#?.??#?# 1,6,2,5
???#.?.### 2,3
?#.#??.#?#??? 1,3,3
???#.?##?.?.#????? 1,1,4,1,1,3
?.#???#.?.#?.????? 1,5,1,1,4
???#???#?????.???.? 3,2,2,1,1,1
??#??.??####?.#?.?. 1,1,6,1,1
?.????#????#?.??#?# 1,1,5,2,5
?????.?????#?. 2,1,2
?.?.?#?????.????.?.? 2,1
?##???????#?????? 2,2,6
????#?#???#??#? 11,2
.?#?#...#?##????? 4,1,4
?#?.?????###???.??? 3,10,1
#?##????.#.????##?? 8,1,6
???????????? 1,4,4
.?..?.#?#??####??# 1,1,12
??#??#????##??#.???? 3,10,2
?????????#????#?.?? 1,4,4,1,1
?#????????????. 1,1,6,1
#?????##??? 8,1
?..?.?#??#??#??. 1,1,9
.?????#..?? 2,2,1
?#???????????.? 7,2
?.??.?#????#? 1,1,7
?????##????. 2,4
???????..#?.? 3,2
?????#.????.?.? 6,2,1,1
#.?.#??.??? 1,3
???????????##?????. 1,1,8,1
?????.#.??#?? 1,1,1,4
????.#?????? 3,1,1,3
????#????##???? 1,9,1
?.???#?..#??????#? 4,4,2
?#????.??#??#???.? 2,1,4,4,1
.#??????#?#?##?? 2,11
.?.???????#??? 1,1,2,2
#?.??..??.?.#??? 2,2,2,2
?..#?.??#???#.?##?? 1,5,4
?#????#??#?????#???. 4,1,1,4,1
??.??#???.?.???#.. 1,2,1,1,4
.???????#?? 1,5
???#?#?????? 2,4,1
?.??#??#.??? 1,1,1,1
?.?#...??#??#?. 2,1,5
.??#??.???? 3,1
#.??.???#?? 1,4
?????.?#?#???? 1,5
?#.?#???#.. 1,5
#????????????.????? 1,1,1,4,2,2
?#?.??##????????? 2,5,2,1
???.?????.????? 3,1,5
.?.?????#???.???? 1,9,2
??????#??#??.#?? 1,8,2
?#???#????. 1,2,2
?#???#??.?#??#???? 6,2,3
#??????#???.?.?? 3,4,1,1,1
????.??.?.?????###?# 3,1,1,8
#.?.?#?????.?????.. 1,2,1,2,1,3
.?.?##???????? 7,1
?#?????#???#?? 5,5
#.???##??? 1,5
??????.##? 1,1,3
.?.????..? 1,1,1
???#?????#?????.?.?? 1,7,1,1,1
??????????#.??#?? 1,3,1,1,4
.#????###? 1,7
??.??#...?#.?? 2,2
???????#?#?? 1,5
??#?#?..?#???? 6,1,2
?#?#????#????????? 2,3,2,2,1
????.#??#? 1,2,4
????#..??.?.?##.. 3,2,1,2
.?#?.#?.?#????###?? 3,2,9
.????#?#?#????????? 1,4,1,7
?#?..#??#??. 1,6
.?????.#????#?..#?? 1,1,1,1,3,3
???.??.?#? 2,2,2
???#?##??#?#.?..? 2,7,1,1,1
##??#??#??????#? 9,1,1,1
?#?#???#.???????. 4,1,4,1
???##??#?#.?? 1,7
??????#?????????? 2,1,1,2,2
?#?##???#?? 1,2,4
?.???##??????????? 1,14
??.?#?????#? 1,3,2
????#???#??.?.?????. 1,7,1,1,1
??#??.##?##??????# 3,8,1,1
???#??#?.???? 2,3,4
?.??#?????? 1,4
??#??#???#??##?? 3,3,1,2
???????#??#?..#?#??? 12,1,2
#?#???#????#??? 3,1,1,5
.??..?##?#.??##....? 4,2
##???#??.#????? 2,2,6
?#?????.???..??????? 5,2,3,1
???????#???#??.??.?. 2,11,1,1
?.??#???#????.. 2,3,1,1
..??..???#.???????? 2,1,5
???????....? 3,1
???#????#??#????#? 1,1,11
??.????..?#? 1,1,2,1
#?.?#?.???? 1,1,2
?#????.??.#? 1,1,1,2
???#?#???#?? 4,1,1
???##?.?#..?.# 5,2,1,1
???##.?#???##??#??? 5,10,1
???#??##.??##.??? 5,2,1
.?##?????..?##???.? 8,2
#??#.?.??#.? 2,1,2,1
.?#?#?.##.#? 4,2,1
??##?.???#?#??#??#? 3,9
.?.??###??#.#?.? 1,4,1,2,1
??#?.?????#? 1,1,1,1
.?#??#?##..?#??#.# 8,5,1
?????#?#???.#.?.?? 1,2,6,1,1,1
.???????#. 3,1
#?#.?????????#?? 3,3,2,2
.????..#?# 1,3
?#????.#.?###??.??? 5,1,5,1,1
????#..#?#??#.??..? 2,1,3,2,1,1
????##??.#?# 3,3
#???#?????????##?## 1,1,2,3,3,2
#????????? 1,2,2
..?#?????????. 8,2
.##..???#???#?.# 2,1,1,4,1
.???.??????.?#?.??? 3,3,3,1
?.#??????#? 1,1,4
?#??.????#?##?? 1,3,4
.??????.??? 5,1
??.??.#.??#? 1,1,3
?#?????????..??????? 9,1
.??#?#???????????# 5,1,1,2,2
##???.??#??# 5,5
???.?????# 2,2
?#???????????#?? 5,4
?#???#.???#.?###??#. 2,2,1,2,3,2
#?.??????? 1,1,3
#???#????.#?.#? 8,2,1
?#.#.??????#??.???? 1,1,1,4,2,1
.#?#??.?????????? 3,1,1,1,2
??????#?????#???? 1,3,7
????.??.?##.. 2,1,1,2
..?#???.??.??.??#??? 4,5
?###????##??#??#. 5,10
?#?#????????.??? 10,1
???#??#?.?#.??? 6,2,1
???????##??#?????.# 1,1,6,1,1
??????#.?? 1,1,1
?##??##.?#???. 6,3
.?#??#.??#?#??.? 1,1,4,1,1
???????????????#.? 12,3
.??#?###?.#????#?. 6,4,1
#?????????? 4,1
?????.????.??. 1,3,2
??.????###?#.???. 2,7,1
?.???????.???#??#? 1,6,1,1,3
???..????##??#?.?? 1,10
?????.????????? 2,7
???.????????##???.? 2,11,1
#?#...???????#??#??? 3,3,7
?#.?#???#? 1,2,3
??#?.?????#.??? 3,1,1
???#??????? 1,3
?????????#?#?.??.?. 11,1
?#?????????.????.??? 11,4,2
??????????????#.? 2,1,2,1,2
?#.##?????#?#?# 1,4,2,1,1
?.??.???????#???#.? 2,1,6,1
??#????#?#.????. 3,3,1,1
?.??.?.??#?.?.? 2,1
??????#??? 1,2,4
#..###???#. 1,7
????..#.???.? 4,1,3,1
??.???##?. 1,4
???#.???#???.?????? 2,1,1,2,5
?????#?##? 1,6
##?##?#?##????????. 10,2,1
.?..????#???? 1,1,5,1
?#???#?.?????.#. 2,1,1,3,1
#?????..?.#?? 5,1,1,1
????????????? 1,3,2
.?.???##??????? 1,10,1
.?#?..???.###? 2,1,3
?..??##?..? 1,4
#?.???##?????.??.? 1,1,6,1,1
###??#???.????# 3,1,1,1,1
???.#???.#? 1,2,1
???.?#?#??????. 5,1
?????????#?#???? 3,5,1
??????#????##?. 1,7
??#????#????#??????? 2,15
?????##??#?????#? 6,7
??###?.??? 3,1
??.##????#? 1,2,2
??#??.?????? 2,2
??#??????.???#####.? 3,1,7
??#?.?..?.? 2,1
?.??.#?#?#????.?? 1,2,6,1,2
#?#.?..#.?????. 3,1,1,2,1
??#???.???? 5,1
##?????.?.??????.? 7,2,2,1
.???#?#???? 1,8
.?##?####.?.????? 8,4
.?...##??#????????. 1,11
??#..?#??? 1,1,1
.?.??.???#?????#??#. 1,1,1,11
?#???#???.#????? 2,5,1,1,1
.?#?.?.?##??.? 3,3,1
.??#?.???#??? 1,4
?#????#???#?... 2,2,2
.?.?#?????#???.. 1,3,1,1,1
#???.?#??# 1,1,5
?????????## 1,1,5
????#??.####?? 1,4,4,1
.??????#?#???????? 1,1,11
?.?#.?#?.??????. 1,1,1,5
???#?.?.????????#?? 2,1,1,1,2,5
##????#????. 8,1
#..###??#?#?# 1,10
?##.??.#.???##.? 2,1,1,4
#?##?#???? 7,1
???#????#???## 5,1,4
?.?#?.???#? 2,1,1
..???????? 2,2
???.??#???????? 1,3,6
????.?#??#????##?#?. 1,1,2,1,2,4
???????.?..??##???#? 1,2,1,4,1,1
.?#????.???##????#?? 3,2,9
?#??#.??#????????? 3,1,2,1,3
???#??#..?? 4,1
?.??#?..?. 3,1
???????#?#?#?##?#? 3,4,1,5
#?.??..????##?###? 2,1,1,8
?..?####?#??#?.?? 1,10,1
#?...???..? 2,2
??????#?????? 1,1,7
????????????#? 1,2,6
.?.#??????#?#??? 1,2,2,7
???##??#?#.????#???? 10,2,1,3
.??#??#.???#? 6,5
####????.#?#?.?.#?#? 4,1,3,1,2
?.????.#?.?##?#? 1,3,1,5
.??????????#.?#??. 2,2,2
???##????#?..?. 5,2,1
.????#.?#?#???? 1,3,7
??.??????? 1,2,1
#?##?????????##?? 4,1,1,1,4
??#?#?.???? 1,3,1
?..#???#?#??. 1,3,5
?#????????#???? 2,11
#?.#?.#?#?##..???#?? 1,2,6,5
??#??????.??.??#. 1,1,5,1,3
?.????????#? 1,1,1,1
??##?.???#?. 4,4
?#??????.?.?#?. 1,2,2,2
??.#?#?????...#? 1,1,1,2,2
...?????.?##??.? 2,3
..??##????. 1,4,1
????.?..???#??#?? 1,1,1,7
.?.??????#. 2,4
..???..#.? 1,1
?.?????????#.?? 2,2
??.#.?#?.?#?#?????? 1,1,2,6,1,1
???#?????#??? 1,7
?##?##.???#?????.?? 6,3,4,1
??###..????#??#..?#? 4,4,2,2
#..????#?#?#?####.? 1,1,1,1,8,1
???#?#?###?#?.?##?.? 9,3
.###?#?#???.??.??? 9,1
??###???#??#? 7,4
.#?.??#????? 2,1,1,3
?#???#?#?.??##???#?. 8,1,3,3
???????#?. 1,1,1
##.?##?????????? 2,10
#.#?.#????#? 1,1,1,1
.#.?????????#? 1,2,2,1
.#????.##? 1,2,2
??????#???##? 1,3,3
?#?#?.?#??.??? 4,3,1
?.#??#?#?#???#?#??? 1,16
?.#???#?#???.##????? 2,2,4,4,1
????.??#???#??.???#? 1,2,1,1,1,4
?##???????#???#??.? 3,1,2,4,1
?#???.????#????.# 4,3,1,1
???#????.???.?#??? 1,3,1,1,1,3
???#??..#?.#??? 4,1,1,1
.?#????.?.?## 1,1,3
?.??##???#?.?#??.? 6,1
?.###???#????#??? 1,4,4,2,1
?.??##?.?#???##?. 1,2,1,5
##??????#??#.???##?? 3,6,6
#?.????##?#??#? 1,2,8
???###.???#?#?#? 3,6
#?.?.??#???#???# 2,1,5,1,2
#?????#?????#??#? 1,1,11
??????..?#? 2,1
????.??????.??????? 1,1,1,2,4
???????#???#?. 2,8
??.????#?? 1,6
?#.?????#.?#????.#?. 2,1,3,5,1
?#?#??.?????#???? 4,7
.??????.???????# 1,4
#?#.???.?#? 3,1,2
????#?..#? 1,2,2
#????.#?#?.?????? 1,1,4,1,1
?#????#?#??. 2,4
?.#???????? 3,1,1
??????#..???#??? 1,1,5
????#??#???????? 6,2,1,1
.#???#?#.##? 5,1,2
????.??????.?.#??# 2,5,4
??????#???#?.??#. 7,1,2,1,1
????#???.#? 6,1
?.??#?#????#??????? 5,5
????#.##??.?? 2,1,2,1
##??###?#???# 10,1
?#????.???????##.# 3,1,1,1,5,1
###??#?.??????? 7,3
??#?##?..???? 4,1
?????###???#?..? 9,2,1
???#????#?. 6,2
???##???#?.?###??. 3,2,6
????#???#?##???? 2,8
.??.????... 1,1
??#..?????#.##?#??# 2,3,1,2,4
.??????##?.? 2,2
????#?.??.? 1,1,2
???#??.???##? 4,1,1,2
??.?##.#?.?#?? 2,3,1,4
?????.?#??# 1,2,1
???.??##??#? 2,2,1
?.?#??##?##?#..?.?#? 5,4,2
.#?#..?..?????.#? 3,1,4,1
?#???#??????#?????#? 3,3,1,9
#?#?#???????#?.#.?# 1,3,4,2,1,1
???.????#??.? 2,5
???##????#?.#. 3,3,1
?????#?????. 1,2,2
.???#???##?#?#?.?#.# 1,10,1,1
?##?????###??.?..?. 4,6,1,1
.??#?.???.? 1,2,1
???##??????##??#?#? 4,2,2,4
#????#?#?? 1,1,4
????#?????? 4,4
????#??..????#?..? 1,1,1,3,1,1
?.??????.?#?# 1,1,1,4
?#?????????##. 4,5
?.###????#???? 6,1,1
???????#?#???#?? 1,2,8,1
???????#?#? 1,3
?###?#??????#??????# 10,2,2,1
?.????.??? 1,1,2
.#?##????.?? 4,1
??.??####??#.??# 9,2
?.?.???.???#?# 1,1,4,1
#?#?#?.#.?#??? 5,1,1,2
??#?#?##???.#?#??#?? 1,9,1,1,1,1
.???#??#??#??? 4,4,1
???#?????.?.??????? 1,7,1,2,1,1
?????###.#??#??.?.# 3,4,1,2,1,1
?#??????#?????##??## 10,7
??????????#???????? 7,4,2
??#????#???? 7,1
?.?#??.??? 1,2,2
????..????????????? 2,3,4,2
.??.???.??#? 1,1,1
#????.??#?.???. 5,3,1,1
???#?#??.?#???#?.#? 3,1,1,6,1
.?????#????###?????? 12,2
#?????#??????? 2,4,3
?###??#???.#. 3,2,1
??.????.??.?????##? 1,2,1,1,8
?????.???? 1,2
.?..?????. 1,1,1
?.?####?#?#???????.? 1,9,1,1,2
.????????????#??. 2,8
?##???.???##??#? 5,7
??????###.?#?? 1,1,4,4
.?..?#???????? 2,2
#??#?##??#?????#.??? 11,2,1,2
.??#.????##.???? 2,1,2,1,1
#???#???.??#.???? 3,1,1,3,4
.??.???#?#?? 1,1,3
.?#??????#?? 9,1
??.?#?#???????##..? 1,13,1
.??#??#?#?????##???? 1,14,1
?#??#?#.????????? 6,2,2,1
#?#??.???????#. 5,7
????.#??#?? 1,5
?#..#??????.?#? 2,6,2
.?#...????##? 2,2,2
.##.?#?.?.?#?.?# 2,2,1,3,1
?????.??##?. 3,1,2
?#???????#????????#? 2,1,2,1,5,1
?##?.??????#? 3,1,1,2
???.??#??.#?? 5,1
.???#?#????###?#..? 4,7
#????.???#?#?.?# 1,3,4,1,1
?????#?#?.???.??.. 2,1,1,1,1,2
.#???.?.??? 4,1
.???#?#..? 1,3
.?#?###???#??? 2,4,3
?##???#??#? 2,6
????.???##?.?? 1,1,4,1
????#.???.??? 3,1,1
?.??#???#??.?#. 5,1
????.??????#???#??.. 3,7
#.???#.????#.??? 1,2,1,3,1
#?#?#????#???#?..?.? 14,1
?#..??#???#? 1,2,2
..#???.???#? 3,1,1
?.???..???.??? 3,2,1
#?#???????#??.??? 1,1,7,2
??????.??.#???.??? 1,3,1,1,1,1
?????#?#?#.????..#?? 8,2,3
.????#.???##.? 5,3
?#???.??.?# 3,1,2
?.??#???.?.? 1,1,1,1
??????...# 3,1,1
.#??#??.?#???.??? 4,1,2,1,1
???##?????????# 5,3,1
?#????????#?? 5,1,1,1
??..?#?..??.? 1,2,1,1
.##??##?#???#?#?#? 2,5,3,1,2
.??..#??.#?.??#???. 2,1,1,2,2,1
??????##?????## 2,5,4
??.??#??#????? 1,9
???#??#??.?? 1,2,2,1
#????.??????? 4,1,2,1
???##.??#?#?#.#??# 5,7,1,1
?????.?.??.?# 4,1,1,2
#??#??##.#.? 1,6,1
.?.??.?#?? 1,3
?#?.??#.???.??#???#? 3,3,2,1,2,1
??#?..??#??#???????? 2,9,1
????#????. 1,4,1
??#????.?????##?#?#? 2,2,1,5,1
.???.???#? 3,1,2
???????.??.? 2,1,1
##?###???? 7,1
?????????#?# 7,1,1
.??#??##?#????#???? 2,12
???????#?#? 1,5
??.?#????? 1,1,1
.?...#??#?#?? 1,2,1,1
?????###?????#?#.? 12,1
?#???##??## 1,8
???#??.?.??.? 2,2
.???.?.##??###?#???. 1,1,7,1,1
?#??????#????.? 4,7
????#?#????#??????? 9,1,6
??#??..#?#? 1,3,4
?.????##???#? 5,2
???#????.??????# 1,1,1,1,5
?#?#???###??#?..? 6,6
..??????.. 1,1
?.?#?.??#.?? 1,2,2,1
????..?????# 1,1,2,1
?.#??#??#.???#??# 7,1,1
??.#??.??.???##?.??? 2,1,2,6,1,1
??#?#..?.#??#?.?##?? 5,1,2,2,4
.????..???? 2,2
#???##.??.? 6,2
.#???#??.#?#?#?## 7,8
?.?..##??#? 1,5
#????????.#??? 8,2
.??.#??#???#?.?..?. 4,2
?#???????#??#?.??# 1,1,7,1
#???#??.??.???. 3,2,1,1
.???#?????.. 2,1,1,1
???????#??#?? 4,2,3
??????.?.???..??.#? 1,1,1,3,2,1
??.???#??..?? 1,5,1
????#?????.????.? 7,2,1
?.?#?#?.???#? 4,2
.???#??#?? 1,1,3
#????#???.?.??# 2,1,1,1,2
#?#??.????? 5,1,1
...#?????? 2,3
..??..???? 1,3
????##??????? 4,1
?.#??.?#?.??# 3,1,1,1
?#????#?.????? 7,1,1
?.??#??.?.??. 3,1,1
?#?#???.????. 4,4
?.?...????.. 1,4
????#?#???#?.?.# 9,1
??.?????#?.?? 1,1,3,1
?.#?.?.??. 1,1,1
?.?#??#????#???.#?? 1,2,7,3
?.??##?.?.#?.? 5,2
??#.??#??#?.??? 2,6,1
?.????#?#?#???? 1,4,6
??#???..#???###????? 1,1,11
?.???#.???.? 1,2,1,1
?.???????.?.?###???? 1,1,1,1,3,3
???##?#?.???.?????? 7,2,3
????##????? 1,4
.#?#??????#? 1,2,1,3
??#?#?.????????. 2,1,8
?.??#?.?#.??? 1,2,1,2
???#??#?#.?????? 8,5
??????#????#???? 1,13
?.????.??.?#????#?? 1,2,1,1,5
???.#?#?.. 1,4
#??????#??? 3,6
?.?###?#??..?#? 7,3
??????#?.?.?????? 2,1,1,5
?#???#.???###???? 3,1,1,5,2
?????????#?#? 1,3,1,4
?????.?????.?#??#? 3,2,4
.#??????.#..??# 1,1,1,1,3
.???#?###??????? 8,3
??#????##?..?? 9,1
.?#?#.??#?.? 2,1,3
###???.???? 4,1,3
?#.??#??## 2,2,3
??..??.?#?#?##?. 1,8
.??????????.? 3,5
??.?#?#???... 1,6
?????????.??????? 4,1,1,1,1
???##?????.???? 7,4
?##???#.?.??..?? 3,1,1,1,1
??#??#?.???.#???# 1,1,1,1,5
???#?##??.???. 7,2
?????#???? 1,2,1
#????????.??# 8,2
??##??????#?#??? 5,5
?.????????.???? 1,1,5,2,1
?.??..????? 1,2
??#??.?#?#?#????. 5,8
????#?.???????#???#? 2,3,8,3
..#???##.?????? 1,1,2,3
#????#?##?#??????? 1,1,7,1,3
#?.????????? 2,1,3
????????.?#? 1,1,2,2
.#?#??.?#???.##??? 5,5,2,1
??????????#?? 9,1
.?##?#????##? 6,3
?.??##??#????##? 1,11
???###????? 7,1
#????##??##?.. 1,8
?.??#??????????.? 5,3
#???.???#?? 4,3
.##??????#?.??. 4,1,1,2
?#??????????. 1,2,3,1
.???#?..#?.?????? 5,2
.?#??????.?#??.?#? 1,1,1,2,1,2
?#?##????#? 4,4
???????#.?????#??#. 1,1,3,1,2,1
??#?????????..???##. 4,1,2,5
.???#.???.? 3,1,1
?.?.?#?###??#??.# 1,1,6,3,1
?#???#?#??..???####? 2,7,8
.?.??????. 1,6
#?#.?#??.??.????#? 1,1,2,1,6
?.???????? 2,3
..??????#??????? 8,1
???#?????..???#?#?#. 7,8
.#??????#?#??? 1,10
???.??#.???. 3,1
.??.??#?.?...? 2,3,1,1
?.????????.###?.#? 1,1,1,1,4,2
??#?????#? 1,1,5
?..###?#???..???? 8,3
???????????##.?. 1,2,7,1
#?###.????? 5,2,1
..?????..?????.? 3,1
.?#??.?#.??????. 3,2,5
?.?#.#??.? 2,3,1
..?#????????????.? 3,2
#????#??#???????? 9,4
????????.#????#.?? 7,6,1
??????#?.??##?? 2,3,3
.????#.??? 1,1,1
?????????????#???.?? 4,8,1
.??#??????#? 3,4
?.#???#.???? 1,5,3
.?.?#??#???#???? 1,1,2,6
.??.#??.?.?#??????? 2,1
??..#.?..? 1,1,1
.#???#?.#.???.???.? 5,1,2,3
????#.????#???#..??? 2,1,3,5,1,1
.???????????#??????. 7,4,2
#??#??#.?.?.???? 7,1,1,1
.?.????#?????#?????? 5,9
????#????#???.?#??? 13,2,1
???????#?##?..# 1,4,5,1
??#???.???#?...## 3,1,3,2
?????.??.???.? 2,1,1,1
#??#??????? 7,1
??.#???#?????? 1,2,8
";

    }
}

